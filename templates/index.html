{% extends 'base.html' %}
{% block title %}é¦–é¡µ - æ­¦æ±‰ç†å·¥ç¤¾å›¢ç®¡ç†{% endblock %}
{% block content %}
	<div class="welcome-banner">
		<h1>æ¬¢è¿ä½¿ç”¨æ­¦æ±‰ç†å·¥ç¤¾å›¢ç®¡ç†ç³»ç»Ÿ</h1>
		<p>é«˜æ•ˆç®¡ç†ç¤¾å›¢äº‹åŠ¡ï¼Œè¿æ¥æ ¡å›­ç¤¾å›¢ç”Ÿæ´»</p>
	</div>

	<!-- è¿‘æœŸæ´»åŠ¨ -->
	<div class="card">
		<div class="card-header-with-icon">
			<h2>ğŸ“… è¿‘æœŸæ´»åŠ¨</h2>
		</div>
		<table class="table">
			<thead>
				<tr><th width="30%">æ´»åŠ¨åç§°</th><th width="25%">æ—¶é—´</th><th width="15%">åœ°ç‚¹</th><th width="15%">ç¤¾å›¢</th><th width="15%">æ“ä½œ</th></tr>
			</thead>
			<tbody>
				{% for e in events %}
				<tr>
					<td><a href="{{ url_for('event_detail', event_id=e.id) }}">{{ e.title }}</a></td>
					<td>{{ e.start_time }}</td>
					<td>{{ e.location }}</td>
					<td>{{ e.club_name }}</td>
					<td>
						<a class="button primary small" href="{{ url_for('event_detail', event_id=e.id) }}">æŸ¥çœ‹è¯¦æƒ…</a>
					</td>
				</tr>
				{% else %}
				<tr><td colspan="5" style="text-align: center; color: var(--muted);">æš‚æ— å·²å®¡æ‰¹çš„æ´»åŠ¨</td></tr>
				{% endfor %}
			</tbody>
		</table>
	</div>

	<!-- ä¸¤åˆ—å¸ƒå±€ -->
	<div class="row">
		<!-- å·¦åˆ—ï¼šæ‹›æ–°å…¬å‘Š -->
		<div>
			<div class="card">
				<div class="card-header-with-icon">
					<h2>ğŸ“ æœ€æ–°æ‹›æ–°</h2>
				</div>
				<table class="table">
					<thead>
						<tr><th>æ ‡é¢˜</th><th>ç¤¾å›¢</th><th>çŠ¶æ€</th><th>æ“ä½œ</th></tr>
					</thead>
					<tbody>
						{% for r in recruitments %}
						<tr>
							<td><a href="{{ url_for('recruitment_detail', rid=r.id) }}">{{ r.title }}</a></td>
							<td>{{ r.club_name }}</td>
							<td>{% if r.is_open %}<span class="tag ok">æŠ¥åä¸­</span>{% else %}<span class="tag pending">å·²å…³é—­</span>{% endif %}</td>
							<td>
								<a class="button primary small" href="{{ url_for('recruitment_detail', rid=r.id) }}">æŸ¥çœ‹</a>
							</td>
						</tr>
						{% else %}
						<tr><td colspan="4" style="text-align: center; color: var(--muted);">æš‚æ— æ‹›æ–°å…¬å‘Š</td></tr>
						{% endfor %}
					</tbody>
				</table>
			</div>
		</div>

		<!-- å³åˆ—ï¼šç¤¾å›¢æ¶ˆæ¯ -->
		<div>
			<div class="card">
				<div class="card-header-with-icon">
					<h2>ğŸ“¢ ç¤¾å›¢æ¶ˆæ¯</h2>
				</div>
				<table class="table">
					<thead>
						<tr><th>æ ‡é¢˜</th><th>ç¤¾å›¢</th><th>æ“ä½œ</th></tr>
					</thead>
					<tbody>
						{% for msg in latest_messages %}
						<tr>
							<td>
								{% if msg.is_important %}
									<span class="tag important">é‡è¦</span>
								{% endif %}
								<a href="{{ url_for('message_detail', message_id=msg.id) }}">{{ msg.title }}</a>
							</td>
							<td>{{ msg.club_name }}</td>
							<td>
								<a class="button primary small" href="{{ url_for('message_detail', message_id=msg.id) }}">æŸ¥çœ‹</a>
							</td>
						</tr>
						{% else %}
						<tr><td colspan="3" style="text-align: center; color: var(--muted);">æš‚æ— ç¤¾å›¢æ¶ˆæ¯</td></tr>
						{% endfor %}
					</tbody>
				</table>
				<div class="card-footer">
					<a class="button ghost" href="{{ url_for('list_messages') }}">æŸ¥çœ‹æ‰€æœ‰æ¶ˆæ¯ â†’</a>
				</div>
			</div>
		</div>
	</div>

	<!-- ç®¡ç†å‘˜ä¸“å±ï¼šå¾…å®¡æ‰¹æ´»åŠ¨ -->
	{% if g.user and g.user.is_admin %}
	<div class="card admin-section" id="events-review">
		<div class="card-header-with-icon">
			<h2>âš™ï¸ å¾…å®¡æ‰¹æ´»åŠ¨</h2>
		</div>
		<table class="table">
			<thead>
				<tr><th width="30%">æ´»åŠ¨åç§°</th><th width="20%">ç¤¾å›¢</th><th width="25%">æ—¶é—´</th><th width="15%">åœ°ç‚¹</th><th width="10%">æ“ä½œ</th></tr>
			</thead>
			<tbody>
				{% for e in pending_events %}
				<tr>
					<td>{{ e.title }}</td>
					<td>{{ e.club_name }}</td>
					<td>{{ e.start_time }}</td>
					<td>{{ e.location }}</td>
					<td>
						<form method="post" action="{{ url_for('approve_event', event_id=e.id) }}" style="display:inline;">
							<button class="button primary small" type="submit">é€šè¿‡</button>
						</form>
					</td>
				</tr>
				{% else %}
				<tr><td colspan="5" style="text-align: center; color: var(--muted);">æš‚æ— å¾…å®¡æ‰¹æ´»åŠ¨</td></tr>
				{% endfor %}
			</tbody>
		</table>
	</div>
	{% endif %}
{% endblock %}


